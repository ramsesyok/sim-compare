# aos_cpp

## 概要
AoS(Array of Structures)でシミュレーションを実装するC++版です。1個体分の情報を構造体にまとめ、24時間ループの更新とタイムライン出力、探知・爆破イベントの生成までを行います。

## 目的と設計のねらい
- 1つのオブジェクト情報を構造体としてまとめ、個体単位の処理を見通しよくする
- JSONスキーマに整合する入力とログ出力の流れを、最小構成で明示する
- 他言語実装とCLI互換を保ちながら、AoSの比較検証を進めやすくする

## コード構成
- `src/main.cpp`
  - CLI引数を受け取り、AoSのシミュレーション処理へつなぐ入口です。
  - AoSの考え方を初心者向けに説明するコメントを冒頭に置いています。
- `src/simulation.cpp` / `include/simulation.hpp`
  - シナリオ読込、AoS配列の初期化、位置更新、探知・爆破イベント生成、ログ出力を担当します。
- `include/aos_storage.hpp`
  - 1個体分の状態をまとめた構造体とAoS配列を定義します。
- `src/logging.cpp` / `include/logging.hpp`
  - タイムラインログとイベントログをJSONとして書き出します。
- `include/jsonobj/`
  - シナリオやログのJSONオブジェクト定義です。`jsonobj`名前空間にまとめています。

## AoSとSoAの簡単な違い
- AoSは1個体の情報を1つの構造体にまとめるため、個体単位の処理が読みやすくなります。
- SoAは属性ごとに配列を分けるため、特定の属性だけを連続して処理しやすくなります。

初めての方向けの例:
- AoSだと「Aさんの位置と速度と所属をまとめて1つの箱に入れる」イメージです。
  その箱を1人ずつ取り出して更新するので、「1人分を見て処理する」流れが追いやすいです。
- SoAだと「位置だけの箱」「速度だけの箱」を分けるイメージです。
  例えば位置更新だけをするときは「位置の箱」だけを順番に見ればよく、無駄なデータを触りにくいです。

## ビルド・実行
```
cmake -S . -B build
cmake --build build
./build/aos_cpp_sim --scenario <path> --timeline-log <path> --event-log <path>
```

CLI11の標準ヘルプは次で確認できます。
```
./build/aos_cpp_sim --help
```

## 入出力の注意
シナリオやログのパスは外部入力です。`schemas/`にあるJSONスキーマと整合する前提で利用し、受け取ったパスの取り扱いには注意してください。
